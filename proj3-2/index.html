<!DOCTYPE html>
<html>

<head>

<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>src</title>


<style type="text/css">
body {
  font-family: Helvetica, arial, sans-serif;
  font-size: 14px;
  line-height: 1.6;
  padding-top: 10px;
  padding-bottom: 10px;
  background-color: white;
  padding: 30px; }

body > *:first-child {
  margin-top: 0 !important; }
body > *:last-child {
  margin-bottom: 0 !important; }

a {
  color: #4183C4; }
a.absent {
  color: #cc0000; }
a.anchor {
  display: block;
  padding-left: 30px;
  margin-left: -30px;
  cursor: pointer;
  position: absolute;
  top: 0;
  left: 0;
  bottom: 0; }

h1, h2, h3, h4, h5, h6 {
  margin: 20px 0 10px;
  padding: 0;
  font-weight: bold;
  -webkit-font-smoothing: antialiased;
  cursor: text;
  position: relative; }

h1:hover a.anchor, h2:hover a.anchor, h3:hover a.anchor, h4:hover a.anchor, h5:hover a.anchor, h6:hover a.anchor {
  background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA09pVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMy1jMDExIDY2LjE0NTY2MSwgMjAxMi8wMi8wNi0xNDo1NjoyNyAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNiAoMTMuMCAyMDEyMDMwNS5tLjQxNSAyMDEyLzAzLzA1OjIxOjAwOjAwKSAgKE1hY2ludG9zaCkiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6OUM2NjlDQjI4ODBGMTFFMTg1ODlEODNERDJBRjUwQTQiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6OUM2NjlDQjM4ODBGMTFFMTg1ODlEODNERDJBRjUwQTQiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo5QzY2OUNCMDg4MEYxMUUxODU4OUQ4M0REMkFGNTBBNCIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo5QzY2OUNCMTg4MEYxMUUxODU4OUQ4M0REMkFGNTBBNCIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PsQhXeAAAABfSURBVHjaYvz//z8DJYCRUgMYQAbAMBQIAvEqkBQWXI6sHqwHiwG70TTBxGaiWwjCTGgOUgJiF1J8wMRAIUA34B4Q76HUBelAfJYSA0CuMIEaRP8wGIkGMA54bgQIMACAmkXJi0hKJQAAAABJRU5ErkJggg==) no-repeat 10px center;
  text-decoration: none; }

h1 tt, h1 code {
  font-size: inherit; }

h2 tt, h2 code {
  font-size: inherit; }

h3 tt, h3 code {
  font-size: inherit; }

h4 tt, h4 code {
  font-size: inherit; }

h5 tt, h5 code {
  font-size: inherit; }

h6 tt, h6 code {
  font-size: inherit; }

h1 {
  font-size: 28px;
  color: black; }

h2 {
  font-size: 24px;
  border-bottom: 1px solid #cccccc;
  color: black; }

h3 {
  font-size: 18px; }

h4 {
  font-size: 16px; }

h5 {
  font-size: 14px; }

h6 {
  color: #777777;
  font-size: 14px; }

p, blockquote, ul, ol, dl, li, table, pre {
  margin: 15px 0; }

hr {
  background: transparent url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAYAAAAECAYAAACtBE5DAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNSBNYWNpbnRvc2giIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6OENDRjNBN0E2NTZBMTFFMEI3QjRBODM4NzJDMjlGNDgiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6OENDRjNBN0I2NTZBMTFFMEI3QjRBODM4NzJDMjlGNDgiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo4Q0NGM0E3ODY1NkExMUUwQjdCNEE4Mzg3MkMyOUY0OCIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo4Q0NGM0E3OTY1NkExMUUwQjdCNEE4Mzg3MkMyOUY0OCIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PqqezsUAAAAfSURBVHjaYmRABcYwBiM2QSA4y4hNEKYDQxAEAAIMAHNGAzhkPOlYAAAAAElFTkSuQmCC) repeat-x 0 0;
  border: 0 none;
  color: #cccccc;
  height: 4px;
  padding: 0;
}

body > h2:first-child {
  margin-top: 0;
  padding-top: 0; }
body > h1:first-child {
  margin-top: 0;
  padding-top: 0; }
  body > h1:first-child + h2 {
    margin-top: 0;
    padding-top: 0; }
body > h3:first-child, body > h4:first-child, body > h5:first-child, body > h6:first-child {
  margin-top: 0;
  padding-top: 0; }

a:first-child h1, a:first-child h2, a:first-child h3, a:first-child h4, a:first-child h5, a:first-child h6 {
  margin-top: 0;
  padding-top: 0; }

h1 p, h2 p, h3 p, h4 p, h5 p, h6 p {
  margin-top: 0; }

li p.first {
  display: inline-block; }
li {
  margin: 0; }
ul, ol {
  padding-left: 30px; }

ul :first-child, ol :first-child {
  margin-top: 0; }

dl {
  padding: 0; }
  dl dt {
    font-size: 14px;
    font-weight: bold;
    font-style: italic;
    padding: 0;
    margin: 15px 0 5px; }
    dl dt:first-child {
      padding: 0; }
    dl dt > :first-child {
      margin-top: 0; }
    dl dt > :last-child {
      margin-bottom: 0; }
  dl dd {
    margin: 0 0 15px;
    padding: 0 15px; }
    dl dd > :first-child {
      margin-top: 0; }
    dl dd > :last-child {
      margin-bottom: 0; }

blockquote {
  border-left: 4px solid #dddddd;
  padding: 0 15px;
  color: #777777; }
  blockquote > :first-child {
    margin-top: 0; }
  blockquote > :last-child {
    margin-bottom: 0; }

table {
  padding: 0;border-collapse: collapse; }
  table tr {
    border-top: 1px solid #cccccc;
    background-color: white;
    margin: 0;
    padding: 0; }
    table tr:nth-child(2n) {
      background-color: #f8f8f8; }
    table tr th {
      font-weight: bold;
      border: 1px solid #cccccc;
      margin: 0;
      padding: 6px 13px; }
    table tr td {
      border: 1px solid #cccccc;
      margin: 0;
      padding: 6px 13px; }
    table tr th :first-child, table tr td :first-child {
      margin-top: 0; }
    table tr th :last-child, table tr td :last-child {
      margin-bottom: 0; }

img {
  max-width: 100%; }

span.frame {
  display: block;
  overflow: hidden; }
  span.frame > span {
    border: 1px solid #dddddd;
    display: block;
    float: left;
    overflow: hidden;
    margin: 13px 0 0;
    padding: 7px;
    width: auto; }
  span.frame span img {
    display: block;
    float: left; }
  span.frame span span {
    clear: both;
    color: #333333;
    display: block;
    padding: 5px 0 0; }
span.align-center {
  display: block;
  overflow: hidden;
  clear: both; }
  span.align-center > span {
    display: block;
    overflow: hidden;
    margin: 13px auto 0;
    text-align: center; }
  span.align-center span img {
    margin: 0 auto;
    text-align: center; }
span.align-right {
  display: block;
  overflow: hidden;
  clear: both; }
  span.align-right > span {
    display: block;
    overflow: hidden;
    margin: 13px 0 0;
    text-align: right; }
  span.align-right span img {
    margin: 0;
    text-align: right; }
span.float-left {
  display: block;
  margin-right: 13px;
  overflow: hidden;
  float: left; }
  span.float-left span {
    margin: 13px 0 0; }
span.float-right {
  display: block;
  margin-left: 13px;
  overflow: hidden;
  float: right; }
  span.float-right > span {
    display: block;
    overflow: hidden;
    margin: 13px auto 0;
    text-align: right; }

code, tt {
  margin: 0 2px;
  padding: 0 5px;
  white-space: nowrap;
  border: 1px solid #eaeaea;
  background-color: #f8f8f8;
  border-radius: 3px; }

pre code {
  margin: 0;
  padding: 0;
  white-space: pre;
  border: none;
  background: transparent; }

.highlight pre {
  background-color: #f8f8f8;
  border: 1px solid #cccccc;
  font-size: 13px;
  line-height: 19px;
  overflow: auto;
  padding: 6px 10px;
  border-radius: 3px; }

pre {
  background-color: #f8f8f8;
  border: 1px solid #cccccc;
  font-size: 13px;
  line-height: 19px;
  overflow: auto;
  padding: 6px 10px;
  border-radius: 3px; }
  pre code, pre tt {
    background-color: transparent;
    border: none; }

sup {
    font-size: 0.83em;
    vertical-align: super;
    line-height: 0;
}

kbd {
  display: inline-block;
  padding: 3px 5px;
  font-size: 11px;
  line-height: 10px;
  color: #555;
  vertical-align: middle;
  background-color: #fcfcfc;
  border: solid 1px #ccc;
  border-bottom-color: #bbb;
  border-radius: 3px;
  box-shadow: inset 0 -1px 0 #bbb
}

* {
	-webkit-print-color-adjust: exact;
}
@media screen and (min-width: 914px) {
    body {
        width: 854px;
        margin:0 auto;
    }
}
@media print {
	table, pre {
		page-break-inside: avoid;
	}
	pre {
		word-wrap: break-word;
	}
  body {
    padding: 2cm; 
  }
}
</style>


</head>

<body>

<h1 id="toc_0">Project 3-2</h1>

<h2 id="toc_1">Introduction</h2>

<p>In this project, we extended our ray tracing system to render more complex and visually interesting scenes. We did this by adding support for mirror and glass materials as well as support for depth of field effects through a parameterizable thin lens approximation.</p>

<p>Our team worked on this project by creating two separate, complete implementations of the project. We did for two reasons. Firstly, we believe that this helps both of us have a much stronger grasp on the material as a lot of the value of this class comes from the process of implementation itself. Secondly, we found this to be a productive means for debugging as having two parallel versions allowed us to more quickly catch and diagnose bugs by swapping in different components across versions until it worked correctly so as to narrow down the source of the issue.</p>

<h2 id="toc_2">Part 1 (Mirror and Glass Materials)</h2>

<p>In this part, we implemented support for mirror and glass materials. These effects rely heavily on multi-bounce illumination to produce their effects, and so to demonstrate our implementation we consider the same <code>CBspheres.dae</code> scene as we modulate the maximum ray depth:</p>

<table>
<thead>
<tr>
<th>Max ray depth = 0</th>
</tr>
</thead>

<tbody>
<tr>
<td><img src="./images/part1/part1_m0.png" alt=""></td>
</tr>
</tbody>
</table>

<p>As expected, in zero bounce illumination, we only see light originating from the light source. This is not quite so interesting as none of our objects are illuminated, so let&#39;s continue.</p>

<table>
<thead>
<tr>
<th>Max ray depth = 1</th>
</tr>
</thead>

<tbody>
<tr>
<td><img src="./images/part1/part1_m1.png" alt=""></td>
</tr>
</tbody>
</table>

<p>With one bounce, we can only see direct reflections. This is why we see the light source and nothing else on both the mirror and glass ball. Additionally, we don&#39;t actually see anything <em>except</em> these reflections at depth 1 because no light is able to bounce off scene surfaces.</p>

<table>
<thead>
<tr>
<th>Max ray depth = 2</th>
</tr>
</thead>

<tbody>
<tr>
<td><img src="./images/part1/part1_m2.png" alt=""></td>
</tr>
</tbody>
</table>

<p>With two bounces, we see two interesting things.</p>

<p>Firstly, the mirror ball now shows a reflection of the scene! This is expected as light can now bounce off the scene <em>and</em> the mirror before hitting the camera. We can actually see this exact behavior by carefully inspecting the mirror ball&#39;s reflection. Observe that the glass ball in the reflection appears entirely black (except for the reflection on top). This, obviously, is not <em>currently</em> the case for the glass ball as it is not just black in the current scene. Rather, what is happening is that the mirror ball is only able to reflect the state of the scene <em>one bounce ago</em> (i.e. the scene as it appeared to the camera with ray depth 1) since the other bounce is consumed by reaching the camera.</p>

<p>Secondly, the glass ball still does not refract any light and instead only has more more complete scene reflections. We do not expect refraction yet, however, because rays are only able to <em>refract</em> and not actually reach any lights with a depth of two (camera-&gt;refract-&gt;scene, expired!). Additionally, we can also observe that the reflections on the glass ball take on the same behavior as the mirror ball by inspecting the far left edge of the ball since it shows the mirror ball appears all black in the reflection except for the reflection of the light.</p>

<table>
<thead>
<tr>
<th>Max ray depth = 3</th>
</tr>
</thead>

<tbody>
<tr>
<td><img src="./images/part1/part1_m3.png" alt=""></td>
</tr>
</tbody>
</table>

<p>At three bounces, the mirror ball continues to display the scene from one ray depth less (as discussed earlier). The glass ball, however, changes enormously and has a number of effects worth discussing.</p>

<p>First, we finally see refraction rather than just reflection! This appears here (and not at depth 2) because our rays are now actually able to make it to the light. This does two things. First, and most obviously, we see the refraction in action by the fact bits of the blue wall appear on the left side of the ball (which is not possible without refraction). Additionally, we see a bright spot on the floor which is caused by the light from above being refracting, causing the ball to behave like a lens.  </p>

<table>
<thead>
<tr>
<th>Max ray depth = 4</th>
</tr>
</thead>

<tbody>
<tr>
<td><img src="./images/part1/part1_m4.png" alt=""></td>
</tr>
</tbody>
</table>

<p>With four bounces, the effects become slightly more subtle. We may observe that the bright spot on the floor causes a reflection on the bottom of the sphere as well as a second bright spot on the wall to the right of the ball. This, similarly, occurs due to the light on the floor refracting at an oblique angel.</p>

<table>
<thead>
<tr>
<th>Max ray depth = 5</th>
</tr>
</thead>

<tbody>
<tr>
<td><img src="./images/part1/part1_m5.png" alt=""></td>
</tr>
</tbody>
</table>

<p>With five bounces the differences become much fainter. The only interesting here is that the mirror ball shows the bright spot on the right wall <em>through</em> the ball. Since the spot is approximately on the center of the ball, this can be seen as a refraction which is nearly perpendicular to the surface, which explains why the dot has about the same brightness/spread on the surface of the mirror as it does on the wall. </p>

<table>
<thead>
<tr>
<th>Max ray depth = 100</th>
</tr>
</thead>

<tbody>
<tr>
<td><img src="./images/part1/part1_m100.png" alt=""></td>
</tr>
</tbody>
</table>

<p>Finally, at 100 bounces not much changes. The scene continues to brighten and, as a result, the top of the glass ball has an increasingly strong reflection from light bouncing from the ceiling.</p>

<h2 id="toc_3">Part 4 (Depth of Field)</h2>

<p>In this part we added support for a thin lens approximation. We did this because our previous tracer used a pinhole camera model which caused everything in the scene to appear in focus, which can be undesirable as it is not how we perceive the world. Pinhole camera models cause everything to appear in focus as every point in space can map to at most one location on the imaging plane as any other rays which could reach that point are blocked by the pinhole barrier. This prevents any point aliasing, which yields a perfectly sharp image for all points. A lens, however, does not have this property except for objects at its focal distance. When an object is nearer or further than the focal distance, the rays of a given point on the object do not converge at a single point and instead scatter, causing point aliasing. This point aliasing appears as blurring and it is a natural part of how we perceive the world through our eyes. </p>

<p>To demonstrate the value of this addition, we consider the visual effect of a thin approximation lens as we modify a few key parameters. First, we consider the <code>CBdragon.dae</code> scene as we rack the focus (radius held at <code>0.3</code>):</p>

<table>
<thead>
<tr>
<th>d = 4.35</th>
<th>d = 4.56</th>
</tr>
</thead>

<tbody>
<tr>
<td><img src="./images/part4/focal/part2_b03_d435.png" alt=""></td>
<td><img src="./images/part4/focal/part2_b03_d456.png" alt=""></td>
</tr>
</tbody>
</table>

<table>
<thead>
<tr>
<th>d = 4.8</th>
<th>d = 5</th>
</tr>
</thead>

<tbody>
<tr>
<td><img src="./images/part4/focal/part2_b03_d48.png" alt=""></td>
<td><img src="./images/part4/focal/part2_b03_d5.png" alt=""></td>
</tr>
</tbody>
</table>

<p>By inspecting the images, we can observe that as the focal distance increases, the region of the scene that appears in focus shifts backwards as expected.</p>

<p>Next, we consider the effect of modifying the aperture (focal distance held at <code>4.56</code>):</p>

<table>
<thead>
<tr>
<th>b = 0.5</th>
<th>b = 0.25</th>
</tr>
</thead>

<tbody>
<tr>
<td><img src="./images/part4/aperture/part2_b05_d456.png" alt=""></td>
<td><img src="./images/part4/aperture/part2_b025_d456.png" alt=""></td>
</tr>
</tbody>
</table>

<table>
<thead>
<tr>
<th>b = 0.125</th>
<th>b = 0.06</th>
</tr>
</thead>

<tbody>
<tr>
<td><img src="./images/part4/aperture/part2_b0125_d456.png" alt=""></td>
<td><img src="./images/part4/aperture/part2_b006_d456.png" alt=""></td>
</tr>
</tbody>
</table>

<p>As expected, when the aperture (i.e. radius) decreases, the amount of scene in focus increases. This makes sense because as the aperture asymptotically approaches zero, it approximates a perfect pinhole camera in which everything is in focus.</p>




</body>

</html>
